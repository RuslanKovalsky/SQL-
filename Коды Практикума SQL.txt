Задача:

3.
За период с 5 июня 2019 года (включительно) выведите:
номер транзакции;
название магазина, где она произошла;
категорию и название приобретённого продукта.
Алгоритм решения
Получите:
id_transaction из таблицы transactions
name_store из таблицы stores
category из таблицы products
name из таблицы products
Методом INNER JOIN соедините таблицу transactions с таблицей products по полю id_product; затем соедините таблицы transactions и stores по полю id_store.
В блоке WHERE укажите условие по дате '2019-06-05'.
Выведите поля: id_transaction, name_store, category, name.

Решение:

SELECT 
	transactions.id_transaction,
    stores.name_store,
    products.category,
    products.name
FROM
	transactions
INNER JOIN products ON transactions.id_product = products.id_product
INNER JOIN stores ON transactions.id_store = stores.id_store
WHERE 	transactions.date > '2019-06-05'

----------------------------------------------------------------------------------

Напишите запрос, который найдёт максимальный вес продукта в категории «молоко и сливки». 
Для приведения значений в запросе к
 числу с плавающей точкой примените конструкцию CAST...AS, в качестве имени укажите max_weight.

Решение:
SELECT 
	MAX (CAST(weight AS real)) AS max_weight
FROM
	products_data_all
WHERE
    units='г'


Задача 1.
.
Напишите запрос, который посчитает общее количество уникальных продуктов в каждом магазине (name_store), информация о котором есть в таблице products_data_all. Назовите переменные name_cnt, name_uniq_cnt соответственно. Выведите название магазина, общее количество продуктов, количество уникальных продуктов.

Решение:
 SELECT 
    name_store,
    COUNT(name) AS name_cnt,
    COUNT(DISTINCT name) AS name_uniq_cnt
FROM
	products_data_all
GROUP BY
    name_store;
1)	Функцией  COUNT считаем сколько всего товаров в столбце name
2)	Функцией DISTINCT перебираем столбец name на уникальные товары.


Задача №2
Напишите запрос, который подсчитает значение максимального веса в каждой категории (category). Назовите переменную max_weight. Выведите категорию и максимальный вес.

SELECT 
    category,
	MAX (CAST(weight AS real)) AS max_weight
FROM
	products_data_all
GROUP BY 
    category;




Задача №3

Напишите запрос, который посчитает среднюю, максимальную и минимальную цены (price) товаров для каждого магазина (name_store) в таблице products_data_all. Назовите переменные соответственно average_price, max_price, min_price.
Выведите название магазина, среднюю, максимальную и минимальную цены.
Менять тип выбираемых из колонок (приводить данные к каком-либо типу) не нужно.

SELECT 
	name_store,
    AVG(price) AS average_price,
    MAX(price) AS max_price,
    MIN(price) AS min_price
FROM
	products_data_all
GROUP BY
	name_store;
